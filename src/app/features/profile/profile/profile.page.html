<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Profile</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Profile</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Loading profile...</p>
  </div>

  <!-- Not Logged In State -->
  <div *ngIf="!isLoading && !currentUser" class="empty-state">
    <ion-icon name="person-circle-outline" class="empty-icon"></ion-icon>
    <h2>Not Logged In</h2>
    <p>Please log in to view your profile</p>
    <ion-button expand="block" (click)="navigateToLogin()">
      <ion-icon slot="start" name="log-in"></ion-icon>
      Login
    </ion-button>
  </div>

  <!-- Profile Content -->
  <div *ngIf="!isLoading && currentUser" class="profile-content">
    
    <!-- Profile Header -->
    <div class="profile-header">
      <div class="avatar-container">
        <img 
          *ngIf="currentUser.photoURL" 
          [src]="currentUser.photoURL" 
          alt="Profile photo"
          class="avatar"
        />
        <ion-icon 
          *ngIf="!currentUser.photoURL" 
          name="person-circle" 
          class="avatar-icon"
        ></ion-icon>
        <ion-button 
          class="edit-avatar-btn" 
          fill="clear" 
          size="small"
          (click)="changeProfilePhoto()"
        >
          <ion-icon slot="icon-only" name="camera"></ion-icon>
        </ion-button>
      </div>
      
      <h2 class="user-name">{{ currentUser.displayName || 'User' }}</h2>
      <p class="user-email">{{ currentUser.email }}</p>
      
      <ion-button 
        fill="outline" 
        size="small" 
        (click)="editProfile()"
      >
        <ion-icon slot="start" name="create"></ion-icon>
        Edit Profile
      </ion-button>
    </div>

    <!-- Booking Statistics -->
    <div class="stats-section">
      <h3>Booking Statistics</h3>
      <div class="stats-grid">
        <div class="stat-card">
          <ion-icon name="calendar" color="primary"></ion-icon>
          <div class="stat-info">
            <p class="stat-value">{{ bookingStats.total }}</p>
            <p class="stat-label">Total Bookings</p>
          </div>
        </div>
        
        <div class="stat-card">
          <ion-icon name="time" color="warning"></ion-icon>
          <div class="stat-info">
            <p class="stat-value">{{ bookingStats.pending }}</p>
            <p class="stat-label">Pending</p>
          </div>
        </div>
        
        <div class="stat-card">
          <ion-icon name="checkmark-circle" color="success"></ion-icon>
          <div class="stat-info">
            <p class="stat-value">{{ bookingStats.confirmed }}</p>
            <p class="stat-label">Confirmed</p>
          </div>
        </div>
        
        <div class="stat-card">
          <ion-icon name="close-circle" color="danger"></ion-icon>
          <div class="stat-info">
            <p class="stat-value">{{ bookingStats.cancelled }}</p>
            <p class="stat-label">Cancelled</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Account Information -->
    <div class="info-section">
      <h3>Account Information</h3>
      <ion-list [inset]="true">
        <ion-item>
          <ion-icon slot="start" name="person"></ion-icon>
          <ion-label>
            <h3>Full Name</h3>
            <p>{{ currentUser.displayName || 'Not set' }}</p>
          </ion-label>
        </ion-item>
        
        <ion-item>
          <ion-icon slot="start" name="mail"></ion-icon>
          <ion-label>
            <h3>Email</h3>
            <p>{{ currentUser.email }}</p>
          </ion-label>
        </ion-item>
        
        <ion-item>
          <ion-icon slot="start" name="calendar"></ion-icon>
          <ion-label>
            <h3>Member Since</h3>
            <p>{{ formatDate(currentUser.createdAt) }}</p>
          </ion-label>
        </ion-item>
        
        <ion-item *ngIf="currentUser.lastLogin">
          <ion-icon slot="start" name="time"></ion-icon>
          <ion-label>
            <h3>Last Login</h3>
            <p>{{ formatDate(currentUser.lastLogin) }}</p>
          </ion-label>
        </ion-item>
      </ion-list>
    </div>

    <!-- Account Actions -->
    <div class="actions-section">
      <h3>Account Actions</h3>
      <ion-list [inset]="true">
        <ion-item button (click)="changePassword()">
          <ion-icon slot="start" name="key"></ion-icon>
          <ion-label>Change Password</ion-label>
          <ion-icon slot="end" name="chevron-forward"></ion-icon>
        </ion-item>
        
        <ion-item button (click)="viewBookings()">
          <ion-icon slot="start" name="calendar"></ion-icon>
          <ion-label>My Bookings</ion-label>
          <ion-icon slot="end" name="chevron-forward"></ion-icon>
        </ion-item>
        
        <ion-item button (click)="logout()" lines="none">
          <ion-icon slot="start" name="log-out" color="danger"></ion-icon>
          <ion-label color="danger">Logout</ion-label>
        </ion-item>
      </ion-list>
    </div>

  </div>
</ion-content>